import{P as V}from"./index.7a0b9c3a.js";import{E as L}from"./element-plus.62ab1451.js";import{F as N,_ as B,a as M}from"./index.86959ff9.js";import{u as H,d as O,b as Q}from"./index.7e7d93d0.js";import{_ as j}from"./index.01b851d7.js";import{D as q}from"./vuedraggable.e8f60bfb.js";import{d as G,r as s,$ as J,e as S,w as K,H as U,n as W,o as X,c as Y,V as i,ab as Z,M as p,a as o,Q as k,T as x,a4 as I,O as ee,P as le,I as ae,ag as $,a1 as te,b7 as oe,b6 as se}from"./@vue.3ddec1b2.js";import{g as ie}from"./@vueuse.b3730649.js";const ne=G({components:{Popup:V,Draggable:q,FileItem:N,Material:B,Preview:M},props:{modelValue:{type:[String,Array],default:()=>[]},type:{type:String,default:"image"},size:{type:String,default:"100px"},fileSize:{type:String,default:"100px"},limit:{type:Number,default:1},disabled:{type:Boolean,default:!1},hiddenUpload:{type:Boolean,default:!1},uploadClass:{type:String,default:""},excludeDomain:{type:Boolean,default:!1}},emits:["change","update:modelValue"],setup(e,{emit:t}){const h=s(),g=s(),_=s(""),w=s(!1),a=s([]),m=s([]),r=s(!0),c=s(-1),{disabled:y,limit:u,modelValue:C}=J(e),{getImageUrl:b}=H(),n=S(()=>{switch(e.type){case"image":return"\u56FE\u7247";case"video":return"\u89C6\u9891";default:return""}}),f=S(()=>e.limit-a.value.length>0),v=S(()=>r.value?u.value==-1?null:u.value-a.value.length:1),A=ie(()=>{const l=m.value.map(d=>e.excludeDomain?d.url:d.uri);r.value?a.value=[...a.value,...l]:a.value.splice(c.value,1,l.shift()),z()},1e3,!1),D=l=>{var d;y.value||(l>=0?(r.value=!1,c.value=l):r.value=!0,(d=h.value)==null||d.open())},F=l=>{m.value=l},z=()=>{const l=u.value!=1?a.value:a.value[0]||"";t("update:modelValue",l),t("change",l),P()},T=l=>{a.value.splice(l,1),z()},R=l=>{_.value=l,w.value=!0},P=()=>{W(()=>{var l;e.hiddenUpload&&(a.value=[]),(l=g.value)==null||l.clearSelect()})};return K(C,l=>{a.value=Array.isArray(l)?l:l==""?[]:[l]},{immediate:!0}),U("limit",e.limit),U("hiddenUpload",e.hiddenUpload),{popupRef:h,materialRef:g,fileList:a,tipsText:n,handleConfirm:A,meterialLimit:v,showUpload:f,showPopup:D,selectChange:F,deleteImg:T,previewUrl:_,showPreview:w,handlePreview:R,handleClose:P,getImageUrl:b}}});const E=e=>(oe("data-v-d04df907"),e=e(),se(),e),re={class:"material-select"},ue=["onClick"],de={class:"operation-btns text-xs text-center"},pe=E(()=>o("span",null,"\u4FEE\u6539",-1)),me=["onClick"],ce=E(()=>o("span",null,"\u6DFB\u52A0",-1)),fe={class:"material-wrap"};function ve(e,t,h,g,_,w){const a=$("file-item"),m=j,r=$("draggable"),c=Q,y=B,u=L,C=V,b=$("preview");return X(),Y("div",re,[i(C,{ref:"popupRef",width:"830px","custom-class":"body-padding",title:`\u9009\u62E9${e.tipsText}`,onConfirm:e.handleConfirm,onClose:e.handleClose},Z({default:p(()=>[i(u,null,{default:p(()=>[o("div",fe,[i(y,{ref:"materialRef",type:e.type,"file-size":e.fileSize,limit:e.meterialLimit,onChange:e.selectChange},null,8,["type","file-size","limit","onChange"])])]),_:1})]),_:2},[e.hiddenUpload?void 0:{name:"trigger",fn:p(()=>[o("div",{class:"material-select__trigger clearfix",onClick:t[1]||(t[1]=I(()=>{},["stop"]))},[i(r,{class:"draggable",list:e.fileList,animation:"300","item-key":"id"},{item:p(({element:n,index:f})=>[o("div",{class:k(["material-preview",{"is-disabled":e.disabled,"is-one":e.limit==1}]),onClick:v=>e.showPopup(f)},[i(m,{onClose:v=>e.deleteImg(f)},{default:p(()=>[i(a,{uri:e.getImageUrl(n),"file-size":e.size,type:e.type},null,8,["uri","file-size","type"])]),_:2},1032,["onClose"]),o("div",de,[pe,x(" | "),o("span",{onClick:I(v=>e.handlePreview(n),["stop"])},"\u67E5\u770B",8,me)])],10,ue)]),_:1},8,["list"]),ee(o("div",{class:k(["material-upload",{"is-disabled":e.disabled,"is-one":e.limit==1,[e.uploadClass]:!0}]),onClick:t[0]||(t[0]=n=>e.showPopup(-1))},[ae(e.$slots,"upload",{},()=>[o("div",{class:"upload-btn",style:te({width:e.size,height:e.size})},[i(c,{size:25,name:"el-icon-Plus"}),ce],4)],!0)],2),[[le,e.showUpload]])])]),key:"0"}]),1032,["title","onConfirm","onClose"]),i(b,{modelValue:e.showPreview,"onUpdate:modelValue":t[2]||(t[2]=n=>e.showPreview=n),url:e.previewUrl,type:e.type},null,8,["modelValue","url","type"])])}const $e=O(ne,[["render",ve],["__scopeId","data-v-d04df907"]]);export{$e as _};
