import{u as H,E as J,V as X,y as I,D as Z,F as ee,A as ue,Y as le,a1 as oe,a0 as te,B as ae}from"./element-plus.62ab1451.js";import{b as se,m as ne,n as de,o as ie,M as m,p as re,t as pe}from"./index.7e7d93d0.js";import{d as W,r as T,s as O,_ as P,e as G,w as me,j as ce,o as i,c as h,V as l,M as o,u as r,a,L as f,W as L,T as _,aa as S,a4 as R,n as q,Q as Fe,U as Ee,S as v}from"./@vue.3ddec1b2.js";import{c as fe}from"./@vueuse.b3730649.js";import{m as _e,a as ve,b as be,c as Ce}from"./menu.b07e7f09.js";import{P as Ve}from"./index.7a0b9c3a.js";const Be={class:"icon-select"},De={class:"flex justify-between"},ye=a("div",{class:"mb-3"},"\u8BF7\u9009\u62E9\u56FE\u6807",-1),he=["onClick"],Ae={class:"h-[280px]"},ke={class:"flex flex-wrap"},Ue={class:"flex w-4"},ge=W({__name:"picker",props:{modelValue:{default:""},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(A,{emit:B}){const D=T(0),k=[{name:"element\u56FE\u6807",icons:ne()},{name:"\u672C\u5730\u56FE\u6807",icons:de()}],b=O(),s=P({inputValue:"",popoverVisible:!1,popoverWidth:0,mouseoverSelect:!1,inputFocus:!1}),x=()=>{s.inputFocus=s.popoverVisible=!0},g=()=>{s.inputFocus=!1,s.popoverVisible=s.mouseoverSelect},N=c=>{s.mouseoverSelect=s.popoverVisible=!1,B("update:modelValue",c),B("change",c)},u=()=>{B("update:modelValue",""),B("change","")},M=G(()=>{var E,C;const c=(C=(E=k[D.value])==null?void 0:E.icons)!=null?C:[];if(!s.inputValue)return c;const d=s.inputValue.toLowerCase();return c.filter(y=>{if(y.toLowerCase().indexOf(d)!==-1)return y})}),w=()=>{q(()=>{var d;const c=(d=b.value)==null?void 0:d.$el.offsetWidth;s.popoverWidth=c<300?300:c})};return fe(document.body,"click",()=>{s.popoverVisible=!!(s.inputFocus||s.mouseoverSelect)}),me(()=>s.popoverVisible,async c=>{var d,E;await q(),c?(d=b.value)==null||d.focus():(E=b.value)==null||E.blur()}),ce(()=>{w()}),(c,d)=>{const E=se,C=H,y=J,$=X;return i(),h("div",Be,[l($,{visible:s.popoverVisible,"onUpdate:visible":d[3]||(d[3]=t=>s.popoverVisible=t),width:s.popoverWidth},{reference:o(()=>[l(r(I),{ref_key:"inputRef",ref:b,modelValue:s.inputValue,"onUpdate:modelValue":d[2]||(d[2]=t=>s.inputValue=t),modelModifiers:{trim:!0},placeholder:"\u641C\u7D22\u56FE\u6807",disabled:A.disabled,onFocus:x,onBlur:g},{prepend:o(()=>[a("div",Ue,[A.modelValue?(i(),f(E,{key:A.modelValue,name:A.modelValue},null,8,["name"])):(i(),h(L,{key:1},[_("\u65E0")],64))])]),append:o(()=>[l(C,null,{default:o(()=>[l(E,{name:"el-icon-Close",size:18,onClick:u})]),_:1})]),_:1},8,["modelValue","disabled"])]),default:o(()=>[a("div",{onMouseover:d[0]||(d[0]=R(t=>s.mouseoverSelect=!0,["stop"])),onMouseout:d[1]||(d[1]=R(t=>s.mouseoverSelect=!1,["stop"]))},[a("div",null,[a("div",De,[ye,a("div",null,[(i(),h(L,null,S(k,(t,e)=>a("span",{key:e,class:Fe(["cursor-pointer text-sm ml-2",{"text-primary":e==D.value}]),onClick:p=>D.value=e},Ee(t.name),11,he)),64))])]),a("div",Ae,[l(y,null,{default:o(()=>[a("div",ke,[(i(!0),h(L,null,S(r(M),t=>(i(),h("div",{key:t,class:"m-1"},[l(C,{onClick:e=>N(t)},{default:o(()=>[l(E,{name:t,size:18},null,8,["name"])]),_:2},1032,["onClick"])]))),128))])]),_:1})])])],32)]),_:1},8,["visible","width"])])}}}),we={class:"edit-popup"},Te={class:"flex-1"},xe=a("div",{class:"form-tips"}," \u8BBF\u95EE\u7684\u8DEF\u7531\u5730\u5740\uFF0C\u5982\uFF1A`user`\uFF0C\u5982\u5916\u7F51\u5730\u5740\u9700\u5185\u94FE\u8BBF\u95EE\u5219\u4EE5`http(s)://`\u5F00\u5934 ",-1),Ne={class:"flex-1"},Me=a("div",{class:"form-tips"}," \u8BBF\u95EE\u7684\u7EC4\u4EF6\u8DEF\u5F84\uFF0C\u5982\uFF1A`user/setting`\uFF0C\u9ED8\u8BA4\u5728`views`\u76EE\u5F55\u4E0B ",-1),$e={class:"flex-1"},Le=a("div",{class:"form-tips"}," \u8BBF\u95EE\u8BE6\u60C5\u9875\u9762\uFF0C\u7F16\u8F91\u9875\u9762\u65F6\uFF0C\u83DC\u5355\u9AD8\u4EAE\u663E\u793A\uFF0C\u5982`/consumer/lists` ",-1),Oe={class:"flex-1"},Se=a("div",{class:"form-tips"}," \u5C06\u4F5C\u4E3Aserver\u7AEFAPI\u9A8C\u6743\u4F7F\u7528\uFF0C\u5982`auth.admin/user`\uFF0C\u8BF7\u8C28\u614E\u4FEE\u6539 ",-1),Re={class:"flex-1"},qe=a("div",{class:"form-tips"},' \u8BBF\u95EE\u8DEF\u7531\u7684\u9ED8\u8BA4\u4F20\u9012\u53C2\u6570\uFF0C\u5982\uFF1A`{"id": 1, "name": "admin"}`\u6216`id=1&name=admin` ',-1),Ie=a("div",{class:"form-tips"},"\u9009\u62E9\u7F13\u5B58\u5219\u4F1A\u88AB`keep-alive`\u7F13\u5B58",-1),We=a("div",{class:"form-tips"}," \u9009\u62E9\u9690\u85CF\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4F46\u4ECD\u7136\u53EF\u4EE5\u8BBF\u95EE ",-1),Pe=a("div",{class:"form-tips"},"\u9009\u62E9\u505C\u7528\u5219\u8DEF\u7531\u5C06\u4E0D\u4F1A\u51FA\u73B0\u5728\u4FA7\u8FB9\u680F\uFF0C\u4E5F\u4E0D\u80FD\u88AB\u8BBF\u95EE",-1),Ge=a("div",{class:"form-tips"},"\u6570\u503C\u8D8A\u5927\u8D8A\u6392\u524D",-1),Je=W({__name:"edit",emits:["success","close"],setup(A,{expose:B,emit:D}){const k=O(),b=O(),s=T("add"),x=G(()=>s.value=="edit"?"\u7F16\u8F91\u83DC\u5355":"\u65B0\u589E\u83DC\u5355"),g=T(ie()),N=(t,e)=>{const p=t?g.value.filter(V=>V.toLowerCase().includes(t.toLowerCase())):g.value;e(p.map(V=>({value:V})))},u=P({id:"",pid:0,type:m.CATALOGUE,icon:"",name:"",sort:0,paths:"",perms:"",component:"",selected:"",params:"",is_cache:0,is_show:1,is_disable:0}),M={pid:[{required:!0,message:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355",trigger:["blur","change"]}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",trigger:"blur"}],paths:[{required:!0,message:"\u8BF7\u8F93\u5165\u8DEF\u7531\u5730\u5740",trigger:"blur"}],component:[{required:!0,message:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u5730\u5740",trigger:"blur"}]},w=T([]),c=async()=>{const t=await _e({page_type:0}),e={id:0,name:"\u9876\u7EA7",children:[]};e.children=re(pe(t.lists).filter(p=>p.type!=m.BUTTON)),w.value.push(e)},d=async()=>{var t,e;await((t=k.value)==null?void 0:t.validate()),s.value=="edit"?await ve(u):await be(u),(e=b.value)==null||e.close(),D("success")},E=(t="add")=>{var e;s.value=t,(e=b.value)==null||e.open()},C=t=>{for(const e in u)t[e]!=null&&t[e]!=null&&(u[e]=t[e])},y=async t=>{const e=await Ce({id:t.id});C(e)},$=()=>{D("close")};return c(),B({open:E,setFormData:C,getDetail:y}),(t,e)=>{const p=Z,V=ee,F=ue,z=le,U=I,j=ge,K=oe,Q=te,Y=ae;return i(),h("div",we,[l(Ve,{ref_key:"popupRef",ref:b,title:r(x),async:!0,width:"550px",onConfirm:d,onClose:$},{default:o(()=>[l(Y,{ref_key:"formRef",ref:k,model:u,"label-width":"80px",rules:M},{default:o(()=>[l(F,{label:"\u83DC\u5355\u7C7B\u578B",prop:"type",required:""},{default:o(()=>[l(V,{modelValue:u.type,"onUpdate:modelValue":e[0]||(e[0]=n=>u.type=n)},{default:o(()=>[l(p,{label:r(m).CATALOGUE},{default:o(()=>[_("\u76EE\u5F55")]),_:1},8,["label"]),l(p,{label:r(m).MENU},{default:o(()=>[_("\u83DC\u5355")]),_:1},8,["label"]),l(p,{label:r(m).BUTTON},{default:o(()=>[_("\u6309\u94AE")]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1}),l(F,{label:"\u7236\u7EA7\u83DC\u5355",prop:"pid"},{default:o(()=>[l(z,{class:"flex-1",modelValue:u.pid,"onUpdate:modelValue":e[1]||(e[1]=n=>u.pid=n),data:w.value,clearable:"","node-key":"id",props:{label:"name"},"default-expand-all":!0,placeholder:"\u8BF7\u9009\u62E9\u7236\u7EA7\u83DC\u5355","check-strictly":""},null,8,["modelValue","data"])]),_:1}),l(F,{label:"\u83DC\u5355\u540D\u79F0",prop:"name"},{default:o(()=>[l(U,{modelValue:u.name,"onUpdate:modelValue":e[2]||(e[2]=n=>u.name=n),placeholder:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),u.type!=r(m).BUTTON?(i(),f(F,{key:0,label:"\u83DC\u5355\u56FE\u6807",prop:"icon"},{default:o(()=>[l(j,{class:"flex-1",modelValue:u.icon,"onUpdate:modelValue":e[3]||(e[3]=n=>u.icon=n)},null,8,["modelValue"])]),_:1})):v("",!0),u.type!=r(m).BUTTON?(i(),f(F,{key:1,label:"\u8DEF\u7531\u8DEF\u5F84",prop:"paths"},{default:o(()=>[a("div",Te,[l(U,{modelValue:u.paths,"onUpdate:modelValue":e[4]||(e[4]=n=>u.paths=n),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u8DEF\u5F84",clearable:""},null,8,["modelValue"]),xe])]),_:1})):v("",!0),u.type==r(m).MENU?(i(),f(F,{key:2,label:"\u7EC4\u4EF6\u8DEF\u5F84",prop:"component"},{default:o(()=>[a("div",Ne,[l(K,{class:"w-full",modelValue:u.component,"onUpdate:modelValue":e[5]||(e[5]=n=>u.component=n),"fetch-suggestions":N,clearable:"",placeholder:"\u8BF7\u8F93\u5165\u7EC4\u4EF6\u8DEF\u5F84"},null,8,["modelValue"]),Me])]),_:1})):v("",!0),u.type==r(m).MENU?(i(),f(F,{key:3,label:"\u9009\u4E2D\u83DC\u5355",prop:"selected"},{default:o(()=>[a("div",$e,[l(U,{modelValue:u.selected,"onUpdate:modelValue":e[6]||(e[6]=n=>u.selected=n),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u8DEF\u5F84",clearable:""},null,8,["modelValue"]),Le])]),_:1})):v("",!0),u.type!=r(m).CATALOGUE?(i(),f(F,{key:4,label:"\u6743\u9650\u5B57\u7B26",prop:"perms"},{default:o(()=>[a("div",Oe,[l(U,{modelValue:u.perms,"onUpdate:modelValue":e[7]||(e[7]=n=>u.perms=n),placeholder:"\u8BF7\u8F93\u5165\u6743\u9650\u5B57\u7B26",clearable:""},null,8,["modelValue"]),Se])]),_:1})):v("",!0),u.type==r(m).MENU?(i(),f(F,{key:5,label:"\u8DEF\u7531\u53C2\u6570",prop:"params"},{default:o(()=>[a("div",null,[a("div",Re,[l(U,{modelValue:u.params,"onUpdate:modelValue":e[8]||(e[8]=n=>u.params=n),placeholder:"\u8BF7\u8F93\u5165\u8DEF\u7531\u53C2\u6570",clearable:""},null,8,["modelValue"])]),qe])]),_:1})):v("",!0),u.type==r(m).MENU?(i(),f(F,{key:6,label:"\u662F\u5426\u7F13\u5B58",prop:"is_cache",required:""},{default:o(()=>[a("div",null,[l(V,{modelValue:u.is_cache,"onUpdate:modelValue":e[9]||(e[9]=n=>u.is_cache=n)},{default:o(()=>[l(p,{label:1},{default:o(()=>[_("\u7F13\u5B58")]),_:1}),l(p,{label:0},{default:o(()=>[_("\u4E0D\u7F13\u5B58")]),_:1})]),_:1},8,["modelValue"]),Ie])]),_:1})):v("",!0),u.type!=r(m).BUTTON?(i(),f(F,{key:7,label:"\u662F\u5426\u663E\u793A",prop:"is_show",required:""},{default:o(()=>[a("div",null,[l(V,{modelValue:u.is_show,"onUpdate:modelValue":e[10]||(e[10]=n=>u.is_show=n)},{default:o(()=>[l(p,{label:1},{default:o(()=>[_("\u663E\u793A")]),_:1}),l(p,{label:0},{default:o(()=>[_("\u9690\u85CF")]),_:1})]),_:1},8,["modelValue"]),We])]),_:1})):v("",!0),u.type!=r(m).BUTTON?(i(),f(F,{key:8,label:"\u83DC\u5355\u72B6\u6001",prop:"is_disable",required:""},{default:o(()=>[a("div",null,[l(V,{modelValue:u.is_disable,"onUpdate:modelValue":e[11]||(e[11]=n=>u.is_disable=n)},{default:o(()=>[l(p,{label:0},{default:o(()=>[_("\u6B63\u5E38")]),_:1}),l(p,{label:1},{default:o(()=>[_("\u505C\u7528")]),_:1})]),_:1},8,["modelValue"]),Pe])]),_:1})):v("",!0),l(F,{label:"\u83DC\u5355\u6392\u5E8F",prop:"sort"},{default:o(()=>[a("div",null,[l(Q,{modelValue:u.sort,"onUpdate:modelValue":e[12]||(e[12]=n=>u.sort=n),min:0},null,8,["modelValue"]),Ge])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])])}}});export{Je as _};
