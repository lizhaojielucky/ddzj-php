import{d as e,W as a,a9 as t,r as s,a as o,o as r,b as l,w as n,e as d,g as u,t as i,k as c,l as m,F as f,f as p,p as _,s as b,n as v,j as g,i as y,v as h,aa as j,h as x,a1 as I,ab as k,y as w,ac as C}from"./index.5b37717f.js";import{_ as z}from"./u-tabs.591e1f26.js";import{_ as V}from"./u-button.71edba3f.js";import{_ as F}from"./u-empty.cc6bdf05.js";import{_ as L}from"./z-paging.ab3f2020.js";import{_ as D}from"./u-image.8c26ebe0.js";import{_ as O}from"./u-count-down.bc076745.js";import{_ as U}from"./plugin-vue_export-helper.21dcd24c.js";import{O as $}from"./index.77dc7d5c.js";import{a as E}from"./order.35b8ae26.js";import{_ as N}from"./index.32cd47b4.js";import{r as Q}from"./util.920cc201.js";import"./u-badge.eadb0f30.js";import"./u-icon.14dc2ec9.js";import"./u-input.81163783.js";import"./u-modal.a6ae2243.js";import"./u-popup.0b900ef6.js";var R=U(e({__name:"order-card",props:{orderInfo:{default:{}}},setup(e){const h=e,j=a(0);t((()=>{const e=h.orderInfo.order_cancel_time,a=(new Date).getTime()/1e3;j.value=1e3*(e-a)}));const x=()=>{v({url:`/pages/order_detail/index?id=${h.orderInfo.id}`})};return(a,t)=>{const v=g,h=s(o("u-image"),D),I=s(o("u-count-down"),O),k=y;return r(),l(v,{class:"card",onClick:b(x,["stop"])},{default:n((()=>[d(v,{class:"card--header flex justify-between"},{default:n((()=>[d(v,{class:"order-sn"},{default:n((()=>[u("订单编号："+i(e.orderInfo.sn),1)])),_:1}),d(v,{class:"status"},{default:n((()=>[u(i(e.orderInfo.order_status_desc),1)])),_:1})])),_:1}),(r(!0),c(f,null,m(e.orderInfo.order_goods,(a=>(r(),l(v,{key:a.id,class:"card--main flex"},{default:n((()=>[d(h,{src:a.goods_image,width:"160",height:"160"},null,8,["src"]),d(v,{class:"ml-[20rpx] service-text"},{default:n((()=>[d(v,{class:"service-text--name truncate"},{default:n((()=>[u(i(a.goods_name),1)])),_:2},1024),d(v,{class:"mt-[16rpx]"},{default:n((()=>[u("预约时间: "+i(e.orderInfo.appoint_time)+" "+i(e.orderInfo.appoint_week),1)])),_:1}),d(v,{class:"mt-[16rpx]"},{default:n((()=>[u("实付金额: ¥"+i(e.orderInfo.order_amount),1)])),_:1})])),_:2},1024)])),_:2},1024)))),128)),d(v,{class:"card--footer flex justify-between items-center"},{default:n((()=>[d(v,{class:"primary"},{default:n((()=>[e.orderInfo.order_cancel_time?(r(),c(f,{key:0},[j.value>=0?(r(),l(v,{key:0,class:"flex items-center"},{default:n((()=>[d(I,{timestamp:j.value,format:"mm:ss","font-size":26,"separator-size":26,onEnd:t[0]||(t[0]=e=>j.value=0)},null,8,["timestamp"]),d(k,{class:"ml-[10rpx]"},{default:n((()=>[u("后自动取消")])),_:1})])),_:1})):p("v-if",!0)],64)):p("v-if",!0)])),_:1}),d(v,null,{default:n((()=>[_(a.$slots,"default",{},void 0,!0)])),_:3})])),_:3})])),_:3},8,["onClick"])}}}),[["__scopeId","data-v-e9d0df2e"]]);const S=e({__name:"order-list",props:{order_status:{default:0}},setup(e){const t=e,u=h(null),i=a([]);j((()=>t.order_status),(()=>{u.value.reload()}));const p=async(e,a)=>{try{const{lists:s}=await E({order_status:t.order_status,page_no:e,page_size:a});u.value.complete(s)}catch(s){console.log("报错=>",s),u.value.complete(!1)}};return(e,a)=>{const t=s(o("z-paging"),L);return r(),l(t,{"auto-show-back-to-top":"",ref_key:"paging",ref:u,modelValue:i.value,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),onQuery:p,fixed:!1,height:"100%"},{default:n((()=>[(r(!0),c(f,null,m(i.value,((e,t)=>(r(),l(R,{key:t,orderInfo:e},{default:n((()=>{var t;return[d($,{orderId:null==e?void 0:e.id,cancel:e.cancel_btn,evaluate:e.comment_btn,contact:e.contact_btn,pay:e.pay_btn,mobile:null==(t=null==e?void 0:e.staff)?void 0:t.mobile,del:null==e?void 0:e.del_btn,type:2,onRefresh:a[0]||(a[0]=e=>x(u).reload())},null,8,["orderId","cancel","evaluate","contact","pay","mobile","del"])]})),_:2},1032,["orderInfo"])))),128))])),_:1},8,["modelValue"])}}});var T=U(e({__name:"index",setup(e){const t=I(),i=a([{name:"全部",order_status:0},{name:"待支付",order_status:1},{name:"预约中",order_status:2},{name:"服务中",order_status:3},{name:"已完成",order_status:4},{name:"已关闭",order_status:5}]),m=a(0),_=e=>{m.value=Number(e)};k((()=>{Q("selectDate")}));return w((async e=>{m.value=1*(null==e?void 0:e.type)||0,Object.keys(e).length||(m.value=0)})),(e,a)=>{const b=s(o("u-tabs"),z),v=g,y=s(o("u-button"),V),h=s(o("u-empty"),F);return r(),c(f,null,[d(v,{class:"order-list"},{default:n((()=>[d(b,{list:i.value,"bg-color":"#F36161","active-color":"#fff","inactive-color":"#fff","is-scroll":!0,modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=e=>m.value=e),onChange:_,height:"80"},null,8,["list","modelValue"]),p(' <tabs\n            :current="current"\n            @change="handleChange"\n            height="80"\n            bar-width="60"\n            :barStyle="{ bottom: \'0\' }"\n            :auth="true"\n            bgColor="#F36161"\n            activeColor="#fff"\n            inactiveColor="#fff"\n        >\n            <tab v-for="(item, i) in tabList" :key="i" :name="item.name"> </tab>\n        </tabs> '),x(t).isLogin?(r(),l(v,{key:0,class:"orderList pt-[20rpx]"},{default:n((()=>[d(S,{order_status:m.value},null,8,["order_status"])])),_:1})):(r(),l(v,{key:1},{default:n((()=>[d(h,{src:"/static/images/empty/order.png",text:"您还没有登录～",mode:"data","icon-size":300,"margin-top":"300",color:"#888888"},{bottom:n((()=>[d(v,{class:"mt-4"},{default:n((()=>[d(y,{shape:"circle",onClick:a[1]||(a[1]=e=>{C({url:"/pages/login/login"})}),ripple:!0,"hair-line":!1,type:"info"},{default:n((()=>[u(" 去登录")])),_:1})])),_:1})])),_:1},8,["src"])])),_:1}))])),_:1}),p(" 底部导航栏 "),d(N)],64)}}}),[["__scopeId","data-v-1a01313f"]]);export{T as default};
