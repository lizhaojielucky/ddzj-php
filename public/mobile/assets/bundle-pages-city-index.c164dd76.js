import{d as e,u as a,W as l,c as t,y as s,bj as c,h as n,bb as u,R as o,o as i,k as d,f as r,e as _,w as v,a7 as g,a8 as f,g as m,F as b,l as h,t as p,s as j,b as x,b6 as y,a6 as k,r as C,a as T,I as w,E as I,j as R,i as F,D as N,Q as A}from"./index.5b37717f.js";import{_ as E}from"./u-icon.14dc2ec9.js";import{h as z}from"./store.4b8bba8f.js";import{_ as B}from"./plugin-vue_export-helper.21dcd24c.js";var D=B(e({__name:"index",setup(e){const B=a(),D=l(!1),K=l(""),L=l(!1),M=l([]),Q=l([]),W=l([]),Y=[{name:"北京市",gcj02_lat:"39.929986",gcj02_lng:"116.395645",id:110100},{name:"上海市",gcj02_lat:"31.249162",gcj02_lng:"121.487899",id:310100},{name:"广州市",gcj02_lat:"23.120049",gcj02_lng:"113.30765",id:440100},{name:"深圳市",gcj02_lat:"22.546054",gcj02_lng:"114.025974",id:440300},{name:"重庆市",gcj02_lat:"29.544606",gcj02_lng:"106.530635",id:110100},{name:"成都市",gcj02_lat:"30.679943",gcj02_lng:"104.067923",id:510100},{name:"杭州市",gcj02_lat:"30.259244",gcj02_lng:"120.219375",id:110100},{name:"苏州市",gcj02_lat:"31.317987",gcj02_lng:"120.619907",id:320500},{name:"武汉市",gcj02_lat:"30.581084",gcj02_lng:"114.3162",id:420100},{name:"沈阳市",gcj02_lat:"41.808645",gcj02_lng:"123.432791",id:210100}],q=l(!1),G=l(0),H=l([]),J=l({}),O=t((()=>B.cityInfo));s((()=>{$()})),c((({scrollTop:e})=>{const a=H.value.findIndex((a=>a>=e));-1!==a&&!n(q)&&(G.value=a)}));const P=()=>{K.value="",L.value=!1,D.value=!1,M.value=[]},S=e=>{var a;if(K.value=null==(a=null==e?void 0:e.detail)?void 0:a.value.trim(),K.value){D.value=!0,M.value=[],console.log("cityList.value",Q.value);for(const e in Q.value){const a=Q.value[e].length,l=Q.value[e];for(let e=0;e<a;e++){new RegExp(K.value).test(l[e].name)&&M.value.push(l[e])}}}else D.value=!1},U=()=>{y({success(e){B.initCityFunc(e.latitude,e.longitude)}})},V=e=>{const a=parseInt(e.changedTouches[0].clientY),l=n(W).length,t=Number(n(J).height/l);let s=Math.floor((a-n(J).top)/t);s<0?s=0:s>l-1&&(s=l-1),n(G)!=s&&(q.value=!0,G.value=s,A({duration:0,scrollTop:n(H)[s]}))},X=()=>{q.value=!1},Z=e=>{const a={name:e.name,city_id:e.id,latitude:e.db09_lat,longitude:e.db09_lng};B.setCityInfo(a),k()},$=async()=>{const e=await z();Q.value=e,W.value=Reflect.ownKeys(null!=e?e:{}),ee()},ee=async()=>{await u();o().selectAll(".bar__sidebar").boundingClientRect((e=>{J.value={height:e[0].height,top:e[0].top}})).exec();o().selectAll(".anchor").boundingClientRect((e=>{e.top=Number(e.bottom),H.value=e.map((e=>Number(e.bottom)))})).exec()},ae=()=>{k()};return(e,a)=>{const l=C(T("u-icon"),E),t=w,s=I,c=R,u=F;return i(),d(b,null,[r(" 搜索 "),_(c,{class:"search flex m-[24rpx]"},{default:v((()=>[r(" 左侧图标 "),_(l,{name:"search",size:"34",color:"#888888"}),r(" 输入 "),_(t,{type:"text",class:"search--input",onInput:S,placeholder:"请输入城市名称",onFocus:a[0]||(a[0]=e=>L.value=!0),onBlur:a[1]||(a[1]=e=>L.value=!1)}),r(" 清空图标 "),g(_(s,{src:"/mobile/assets/icon_clear.6781ad66.png",class:"clear",onClick:P},null,512),[[f,L.value]])])),_:1}),r(" 搜索结果 "),g(_(c,{class:"city-container"},{default:v((()=>[_(c,{class:"letter-head"},{default:v((()=>[m("搜索结果")])),_:1}),_(c,{class:"bg-white city-box-head"},{default:v((()=>[(i(!0),d(b,null,h(M.value,((e,a)=>(i(),x(c,{key:a,class:"text-base city-item",onClick:a=>Z(e)},{default:v((()=>[m(p(e.name),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1},512),[[f,D.value]]),r(" 定位城市 "),g(_(c,null,{default:v((()=>[_(c,{class:"city-container"},{default:v((()=>[r(" 当前定位城市 "),_(c,{class:"letter-head"},{default:v((()=>[m("当前定位城市")])),_:1}),_(c,{class:"city-box-head flex justify-between bg-white p-[24rpx]"},{default:v((()=>[_(c,{class:"flex text-base normal",onClick:ae},{default:v((()=>[_(s,{src:"/mobile/assets/icon_city_address.e6cf7fd5.png"}),_(u,{class:"ml-[18rpx]"},{default:v((()=>[m(p(n(O).name),1)])),_:1})])),_:1}),_(c,{class:"flex text-base text-blue",onClick:U},{default:v((()=>[m("重新定位")])),_:1})])),_:1}),r(" 热门城市列表 "),_(c,null,{default:v((()=>[_(c,{class:"letter-head"},{default:v((()=>[m("热门城市")])),_:1}),_(c,{class:"city-box-head"},{default:v((()=>[(i(),d(b,null,h(Y,((e,a)=>_(c,{key:a,class:"text-base city-item",onClick:a=>Z(e)},{default:v((()=>[m(p(e.name),1)])),_:2},1032,["onClick"]))),64))])),_:1})])),_:1}),r(" 城市列表 "),(i(!0),d(b,null,h(Q.value,((e,a)=>(i(),x(c,{key:a,class:"anchor"},{default:v((()=>[_(c,{class:"letter"},{default:v((()=>[m(p(a),1)])),_:2},1024),_(c,{class:"bg-white city-box"},{default:v((()=>[(i(!0),d(b,null,h(e,((e,a)=>(i(),x(c,{key:a,class:"text-base truncate city-item",onClick:a=>Z(e)},{default:v((()=>[m(p(e.name),1)])),_:2},1032,["onClick"])))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1}),r(" 侧边导航条 "),_(c,{class:"bar__sidebar",onTouchstart:j(V,["stop","prevent"]),onTouchmove:j(V,["stop","prevent"]),onTouchend:j(X,["stop","prevent"]),onTouchcancel:j(X,["stop","prevent"])},{default:v((()=>[(i(!0),d(b,null,h(W.value,((e,a)=>(i(),x(c,{key:a,class:N(["bar__index","title "+(a==G.value?"active":"")])},{default:v((()=>[m(p(e),1)])),_:2},1032,["class"])))),128))])),_:1},8,["onTouchstart","onTouchmove","onTouchend","onTouchcancel"]),r(" 侧边弹窗 "),q.value&&W.value[G.value+""]?(i(),x(c,{key:0,class:"list-alert"},{default:v((()=>[_(u,null,{default:v((()=>[m(p(W.value[G.value]),1)])),_:1})])),_:1})):r("v-if",!0)])),_:1},512),[[f,!D.value]])],64)}}}),[["__scopeId","data-v-997ce094"]]);export{D as default};
