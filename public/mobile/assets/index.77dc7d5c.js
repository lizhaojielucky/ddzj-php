import{d as e,W as a,r as t,a as l,o as r,k as o,e as u,w as d,f as s,b as n,g as i,s as c,F as p,t as f,n as m,ad as x,ae as h,a5 as b,j as _}from"./index.5b37717f.js";import{_ as g}from"./u-input.81163783.js";import{_ as y}from"./u-modal.a6ae2243.js";import{_ as v}from"./u-image.8c26ebe0.js";import{_ as k}from"./u-popup.0b900ef6.js";import{b as w,c as C,d as B,e as j}from"./order.35b8ae26.js";import{t as I}from"./util.920cc201.js";import{_ as V}from"./plugin-vue_export-helper.21dcd24c.js";var N=V(e({__name:"index",props:{orderId:{default:""},cancel:{type:[Boolean,Number,null],default:!1},evaluate:{type:[Boolean,Number,null],default:!1},contact:{type:[Boolean,Number,null],default:!1},pay:{type:[Boolean,Number,null],default:!1},confirmService:{type:[Boolean,Number,null],default:!1},verification:{type:[Boolean,Number,null],default:!1},mobile:{default:""},type:{default:2},orderStatus:{default:""},del:{type:[Boolean,Number,null],default:!1},goods_image:null,goods_name:null},emits:["refresh","backRefresh"],setup(e,{emit:V}){const N=e,$=a(""),S=a(!1),U=()=>{m({url:`/bundle/pages/order_pay/order_pay?order_id=${N.orderId}&from=order`})},F=async()=>{if(!isWeixinClient())return I("h5暂不支持扫码");S.value=!0},M=a(!1),O=async()=>{try{await j({verification_code:$.value}),$.value="",uni.$u.toast("订单核销成功"),M.value=!1,V("refresh")}catch(e){uni.$u.toast(e)}},W=async()=>{if(""===$.value)return I("请输入核销码");await j({verification_code:$.value}),uni.$u.toast("订单核销成功"),$.value="",V("refresh")},A=()=>{$.value="",V("refresh")};return(a,j)=>{const I=b,D=_,L=t(l("u-input"),g),R=t(l("u-modal"),y),q=t(l("u-image"),v),z=t(l("u-popup"),k);return r(),o(p,null,[u(D,{class:"flex"},{default:d((()=>[s(" 取消订单 "),e.cancel?(r(),n(I,{key:0,class:"Btn bg-white text-base text-black leading-[60rpx] h-[60rpx] rounded-full",onClick:j[0]||(j[0]=c((a=>(async e=>{if(!(await x({title:"温馨提示",content:"确认取消该订单吗？"})).cancel){try{await w({id:N.orderId})}catch(a){console.log("错误信息：",a,N.orderId)}V("refresh")}})(e.orderId)),["stop"]))},{default:d((()=>[i(" 取消订单 ")])),_:1})):s("v-if",!0),s(" 删除订单 "),4==e.orderStatus||e.del?(r(),n(I,{key:1,class:"Btn bg-white text-base text-black leading-[60rpx] h-[60rpx] rounded-full",onClick:j[1]||(j[1]=c((a=>(async e=>{if(!(await x({title:"温馨提示",content:"确认删除该订单吗？"})).cancel){try{await C({id:N.orderId}),V("refresh")}catch(a){console.log("错误信息：",a,N.orderId)}await V("refresh")}})(e.orderId)),["stop"]))},{default:d((()=>[i(" 删除订单 ")])),_:1})):s("v-if",!0),s(" 去评价 "),e.evaluate?(r(),n(I,{key:2,class:"Btn bg-white text-sm text-muted leading-[60rpx] h-[60rpx] rounded-full mx-3",onClick:j[2]||(j[2]=c((e=>{m({url:"/bundle/pages/evaluate_list/index"})}),["stop"]))},{default:d((()=>[i(" 去评价 ")])),_:1})):s("v-if",!0),s(" 联系师傅 "),e.contact?(r(),n(I,{key:3,class:"Btn bg-white text-sm text-muted leading-[60rpx] h-[60rpx] rounded-full",onClick:j[3]||(j[3]=c((e=>{h({phoneNumber:N.mobile})}),["stop"]))},{default:d((()=>[i(" 联系师傅 ")])),_:1})):s("v-if",!0),s(" 去支付 "),e.pay?(r(),n(I,{key:4,class:"bg-primary text-lg ml-[20rpx] text-white leading-[60rpx] h-[60rpx] rounded-full",onClick:c(U,["stop"])},{default:d((()=>[i(" 去支付 ")])),_:1},8,["onClick"])):s("v-if",!0),s(" 确认服务 "),e.confirmService?(r(),n(I,{key:5,class:"bg-primary text-lg text-white leading-[60rpx] h-[60rpx] rounded-full",onClick:j[4]||(j[4]=c((a=>(async e=>{(await x({title:"温馨提示",content:"确认服务该订单吗？"})).cancel||(await B({id:e}),uni.$u.toast("操作成功"),V("refresh"))})(e.orderId)),["stop"]))},{default:d((()=>[i(" 确认服务 ")])),_:1})):s("v-if",!0),s(" 核销订单 "),e.verification?(r(),o(p,{key:6},[u(D,{class:"flex justify-around"},{default:d((()=>[u(I,{class:"Btn flex-1 mr-2 bg-white text-sm text-black leading-[70rpx] h-[70rpx] rounded-full",onClick:j[5]||(j[5]=c((e=>S.value=!0),["stop"]))},{default:d((()=>[i(" 手动核销码 ")])),_:1}),u(I,{class:"flex-1 bg-primary text-sm text-white leading-[70rpx] h-[70rpx] rounded-full",onClick:c(F,["stop"])},{default:d((()=>[i(" 扫码核销 ")])),_:1},8,["onClick"])])),_:1}),s(" 手动输入核销码MODAL "),u(R,{ref:"uModalInput",modelValue:S.value,"onUpdate:modelValue":j[7]||(j[7]=e=>S.value=e),"show-cancel-button":"",confirmColor:"#F36161","confirm-text":"确定",onConfirm:W,onCancel:A,title:"手动核销"},{default:d((()=>[u(D,{class:"slot-content justify-center",style:{padding:"60rpx 40rpx"}},{default:d((()=>[u(L,{type:"number",modelValue:$.value,"onUpdate:modelValue":j[6]||(j[6]=e=>$.value=e),border:!0,placeholder:"请输入核销码",style:{width:"100%"}},null,8,["modelValue"])])),_:1})])),_:1},8,["modelValue"])],64)):s("v-if",!0)])),_:1}),u(z,{modelValue:M.value,"onUpdate:modelValue":j[8]||(j[8]=e=>M.value=e),mode:"center",height:"500","border-radius":"14"},{default:d((()=>[u(D,{class:"text-center w-[560rpx] pt-[40rpx]"},{default:d((()=>[u(D,{class:"w-[160rpx] h-[160rpx] px-[200rpx]"},{default:d((()=>[u(q,{width:"160",height:"160",src:e.goods_image},null,8,["src"])])),_:1}),u(D,{class:"mt-[20rpx] truncate"},{default:d((()=>[i(f(e.goods_name),1)])),_:1}),u(D,{class:"mt-[10rpx] mb-[40rpx] text-[#f36161]"},{default:d((()=>[i("完成服务请点击确认")])),_:1}),u(I,{class:"flex-1 bg-primary text-sm text-white leading-[70rpx] h-[70rpx] rounded-full mx-[40rpx]",onClick:c(O,["stop"])},{default:d((()=>[i(" 确认核销 ")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-7a9ad16f"]]);export{N as O};
