import{d as e,W as a,y as l,aE as t,K as s,b2 as o,z as u,ar as r,o as d,b as i,w as c,f as n,e as f,g as m,s as p,b3 as _,b4 as v,a6 as g,b5 as b,b6 as x,b7 as y,b8 as h,j as w,r as V,a as k,E as C,i as j,a5 as $}from"./index.5b37717f.js";import{_ as E}from"./u-input.81163783.js";import{_ as S}from"./u-form-item.282419c2.js";import{_ as U}from"./u-icon.14dc2ec9.js";import{_ as q}from"./u-form.58f87cc9.js";import{_ as F}from"./u-modal.a6ae2243.js";import{_ as T}from"./plugin-vue_export-helper.21dcd24c.js";import"./u-popup.0b900ef6.js";var z=T(e({__name:"index",setup(e){const T=a({contact:"",mobile:"",province:"",province_id:"",city:"",city_id:"",district:"",district_id:"",address:"",is_default:0,region:""}),z=a(),A=a(""),M=a(!1),N=a({contact:[{required:!0,message:"请输入联系人",trigger:["change","blur"]},{min:1,max:20,message:"输入长度不得超过20位",trigger:["blur","change"]}],mobile:[{required:!0,message:"请输入手机号码",trigger:["change","blur"]},{pattern:/^1[3-9]\d{9}$/,transform:e=>String(e),message:"请输入正确的手机号"}],region:[{required:!0,message:"请选择省市区",trigger:["change","blur"]}],address:[{required:!0,message:"请输入门牌号",trigger:["change","blur"]}]}),R=()=>{z.value.validate((e=>{if(!e)return!1;A.value?I():B()}))},B=async()=>{await v({...T.value}),setTimeout((()=>{g()}),300)},I=async()=>{await b({...T.value}),setTimeout((()=>{g()}),300)},J=()=>{x({success(e){K(e.latitude,e.longitude)},fail(e){console.log(e)}})},K=async(e,a)=>{try{const l=(await y({location:`${e},${a}`})).result;O(l)}catch(l){console.log("地址逆解析",l)}},O=e=>{let a=e.ad_info.city_code.substr(3,6);11e4!=a&&31e4!=a&&21e4!=a&&41e4!=a||(a*=1,a+=100),T.value.city_id=a+"",T.value.province_id=T.value.city_id.substr(0,3)+"000",T.value.district_id=e.ad_info.adcode,T.value.region=`${e.ad_info.province} ${e.ad_info.city} ${e.ad_info.district}`,T.value.address=e.address_component.street_number},W=async()=>{try{await h({id:A.value}),setTimeout((()=>{g()}),300)}catch(e){console.log(e)}};return l((e=>{if(A.value=Number(e.id),e.id)t({title:"编辑地址"}),(async()=>{T.value=await _({id:A.value}),T.value.region=`${T.value.province} ${T.value.city} ${T.value.district}`})();else{t({title:"添加地址"});let e=s("wxAddress");if(!e)return;e=JSON.parse(e),T.value.contact=e.name,T.value.mobile=e.mobile,K(e.latitude,e.longitude)}})),o((()=>{var e;null==(e=z.value)||e.setRules(N.value)})),u((()=>{r("wxAddress")})),(e,a)=>{const l=w,t=V(k("u-input"),E),s=V(k("u-form-item"),S),o=V(k("u-icon"),U),u=C,r=j,_=V(k("u-form"),q),v=$,g=V(k("u-modal"),F);return d(),i(l,{class:"container"},{default:c((()=>[n(" Mian Start "),f(_,{model:T.value,ref_key:"formRef",ref:z,"error-type":["message","toast"]},{default:c((()=>[n(" 联系人 "),f(l,{class:"card"},{default:c((()=>[f(s,{prop:"contact"},{default:c((()=>[f(l,{class:"flex"},{default:c((()=>[f(l,{class:"label"},{default:c((()=>[m(" 联系人 ")])),_:1}),f(t,{modelValue:T.value.contact,"onUpdate:modelValue":a[0]||(a[0]=e=>T.value.contact=e),placeholder:"请输入联系人"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(" 手机号 "),f(l,{class:"card"},{default:c((()=>[f(s,{prop:"mobile"},{default:c((()=>[f(l,{class:"flex"},{default:c((()=>[f(l,{class:"label"},{default:c((()=>[m(" 手机号 ")])),_:1}),f(t,{modelValue:T.value.mobile,"onUpdate:modelValue":a[1]||(a[1]=e=>T.value.mobile=e),placeholder:"请输入手机号码"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),n(" 省市区 "),f(l,{class:"card"},{default:c((()=>[f(s,{prop:"region"},{default:c((()=>[f(l,{class:"flex relative",style:{width:"100%"},onClick:J},{default:c((()=>[f(l,{class:"label"},{default:c((()=>[m(" 省市区 ")])),_:1}),f(l,{class:"flex-1"},{default:c((()=>[f(t,{onClick:p(J,["stop"]),modelValue:T.value.region,"onUpdate:modelValue":a[2]||(a[2]=e=>T.value.region=e),placeholder:"请选择",disabled:!0},null,8,["onClick","modelValue"])])),_:1}),f(l,{class:"absolute w-full h-full opacity-0",onClick:J}),f(o,{name:"arrow-right",size:"22",color:"#888888"})])),_:1})])),_:1})])),_:1}),n(" 门牌号 "),f(l,{class:"card"},{default:c((()=>[f(s,{prop:"address"},{default:c((()=>[f(l,{class:"flex w-full col-start"},{default:c((()=>[f(l,{class:"label"},{default:c((()=>[m(" 门牌号 ")])),_:1}),f(l,{class:"flex-1 pt-[6rpx]"},{default:c((()=>[f(t,{modelValue:T.value.address,"onUpdate:modelValue":a[3]||(a[3]=e=>T.value.address=e),type:"textarea",placeholder:"请选择",height:"124"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),n(" 是否默认地址 "),f(l,{class:"is-default flex m-[20rpx]",onClick:a[4]||(a[4]=e=>T.value.is_default=!T.value.is_default)},{default:c((()=>[T.value.is_default?(d(),i(u,{key:0,src:"/mobile/static/images/icon_select.png",mode:""})):n("v-if",!0),T.value.is_default?n("v-if",!0):(d(),i(u,{key:1,src:"/mobile/static/images/icon_unselect.png",mode:""})),f(r,{class:"text-xs normal ml-[15rpx]"},{default:c((()=>[m("设为默认")])),_:1})])),_:1})])),_:1},8,["model"]),n(" Mian End "),n(" Footer Start "),f(l,{class:"flex m-[20rpx] pt-[30rpx]"},{default:c((()=>[A.value?(d(),i(l,{key:0,class:"flex-1 mr-[20rpx]"},{default:c((()=>[f(v,{class:"bg-white text-lg text-black rounded-full leading-[80rpx] h-[80rpx]",onClick:a[5]||(a[5]=e=>M.value=!0)},{default:c((()=>[m(" 删除 ")])),_:1})])),_:1})):n("v-if",!0),f(l,{class:"flex-1"},{default:c((()=>[f(v,{class:"bg-primary text-lg text-white rounded-full leading-[80rpx] h-[80rpx]",onClick:R},{default:c((()=>[m(" 保存 ")])),_:1})])),_:1})])),_:1}),n(" Footer End "),n(" 删除地址 弹窗 Start "),f(g,{id:"delete-dialog",modelValue:M.value,"onUpdate:modelValue":a[6]||(a[6]=e=>M.value=e),showCancelButton:!0,"confirm-text":"狠心删除",title:"温馨提示","confirm-color":"#F36161",onConfirm:W,onCancel:a[7]||(a[7]=e=>M.value=!1)},{default:c((()=>[f(l,{class:"text-center p-[50rpx]"},{default:c((()=>[f(r,null,{default:c((()=>[m("确认删除该地址吗？")])),_:1})])),_:1})])),_:1},8,["modelValue"]),n(" 删除地址 弹窗 End ")])),_:1})}}}),[["__scopeId","data-v-69d66672"]]);export{z as default};
