import{d as a,aS as e,o as s,b as t,w as l,f as r,e as c,g as o,k as u,l as h,t as n,F as i,j as d,x as p,W as _,v as f,ao as m,aT as g,a7 as x,a8 as v,ad as y,r as b,a as k}from"./index.5b37717f.js";import{_ as w}from"./u-search.bf82fac5.js";import{_ as j}from"./z-paging.ab3f2020.js";import{_ as C}from"./plugin-vue_export-helper.21dcd24c.js";import{g as V,b as z}from"./store.4b8bba8f.js";import{G as S}from"./index.e86ff0a3.js";import"./u-icon.14dc2ec9.js";import"./u-image.8c26ebe0.js";import"./index.73a8a495.js";var I=C(a({__name:"suggest",props:{hot_search:{default:[]},his_search:{default:[]},status:{default:0}},emits:["search","clear"],setup(a,{emit:p}){const _=a,f=a=>{p("search",a)};return e((()=>{console.log("props",_.hot_search)})),(e,_)=>{const m=d;return s(),t(m,{class:"bg-white suggest"},{default:l((()=>[r(" 热门搜索 "),a.hot_search.length&&1==a.status?(s(),t(m,{key:0,class:"hot"},{default:l((()=>[c(m,{class:"font-medium pl-[24rpx] pt-[26rpx] pb-[6rpx] text-lg"},{default:l((()=>[o("热门搜索")])),_:1}),c(m,{class:"w-full px-[24rpx]"},{default:l((()=>[(s(!0),u(i,null,h(a.hot_search,((a,e)=>(s(),t(m,{key:e,class:"max-w-full truncate keyword",onClick:e=>f(a.name)},{default:l((()=>[o(n(a.name),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):r("v-if",!0),a.hot_search.length&&a.his_search.length?(s(),t(m,{key:1,class:"mx-[24rpx] my-[40rpx]"})):r("v-if",!0),r(" 历史搜索 "),a.his_search.length?(s(),t(m,{key:2,class:"history"},{default:l((()=>[c(m,{class:"flex justify-between px-[24rpx] pb-[6rpx] pt-[26rpx]"},{default:l((()=>[c(m,{class:"text-lg font-medium"},{default:l((()=>[o("历史搜索")])),_:1}),c(m,{class:"text-xs text-muted",onClick:_[0]||(_[0]=()=>p("clear"))},{default:l((()=>[o("清空")])),_:1})])),_:1}),c(m,{class:"w-full px-[24rpx]"},{default:l((()=>[(s(!0),u(i,null,h(a.his_search,((a,e)=>(s(),t(m,{key:e,class:"truncate keyword",onClick:e=>f(a)},{default:l((()=>[o(n(a),1)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})):r("v-if",!0)])),_:1})}}}),[["__scopeId","data-v-27c285ee"]]);var L=C(a({__name:"index",setup(a){const e=p({hot_search:[],his_search:[],result:[],searching:!1,status:0}),o=_(""),u=f(),h=a=>{o.value=a,o.value&&(e.his_search.includes(o.value)||(e.his_search.unshift(o.value),m.set(g,e.his_search))),u.value.reload(),e.searching=!0},n=async()=>{(await y({title:"温馨提示",content:"是否清空历史记录？"})).confirm&&(m.set(g,""),e.his_search=[])},i=async(a,e)=>{try{const{lists:s}=await z({keyword:o.value,page_no:a,page_size:e});u.value.complete(s)}catch(s){console.log("报错=>",s),u.value.complete(!1)}};return(async()=>{try{const a=await V();e.hot_search=a.data,e.status=a.status}catch(a){console.log("获取热门搜索失败=>",a)}})(),e.his_search=m.get(g)||[],(a,p)=>{const _=b(k("u-search"),w),f=d,m=b(k("z-paging"),j);return s(),t(f,{class:"search"},{default:l((()=>[r(" 搜索框 "),c(f,{class:"px-[24rpx] py-[14rpx] bg-white"},{default:l((()=>[c(_,{modelValue:o.value,"onUpdate:modelValue":p[0]||(p[0]=a=>o.value=a),placeholder:"请输入关键词搜索",height:"72",onSearch:h,onCustom:h,onClear:p[1]||(p[1]=a=>e.searching=!1)},null,8,["modelValue"])])),_:1}),r(" 搜索 "),c(f,{class:"search-content"},{default:l((()=>[r("  "),x(c(I,{onSearch:h,onClear:n,hot_search:e.hot_search,his_search:e.his_search,status:e.status},null,8,["hot_search","his_search","status"]),[[v,!e.searching]]),r("  "),x(c(f,{class:"search-content-s pt-[20rpx]"},{default:l((()=>[c(m,{ref_key:"paging",ref:u,modelValue:e.result,"onUpdate:modelValue":p[2]||(p[2]=a=>e.result=a),onQuery:i,fixed:!1,height:"100%"},{default:l((()=>[c(f,{class:"bg-white px-[24rpx]"},{default:l((()=>[c(S,{goodsList:e.result},null,8,["goodsList"])])),_:1})])),_:1},8,["modelValue"])])),_:1},512),[[v,e.searching]])])),_:1})])),_:1})}}}),[["__scopeId","data-v-b0ddfee6"]]);export{L as default};
